# logging file
LOG_FILE: '/opt/ptolemy/var/log/stored-postgres.log'

WORKERS: 36

#######################################################################
# Agent Settings
#######################################################################

POOL: 'postgres.default'
KEYS:
    - '#.spanning_tree.#'
    - '#.entity.#'
    - '#.ports.#'
    - '#.layer1_peer.#'
    - '#.arps.#'
    # - '#.property_control.#'
    - '#.dns.#'
    - '#.spec.wireless.#'
    - '#.spec.ip_sla.group.meta.#'
    - '#.layer3.#'
    - '#.spec.ipam.#'
    - '#.spec.alert.#'
    - '#.meta.#'
    - '#.spec.caching.#'

#######################################################################
# POSTGRES Settings
#######################################################################

POSTGRES_HOST: 'net-graphite01.slac.stanford.edu'
POSTGRES_PORT: 5432
POSTGRES_DATABASE: 'ptolemy_production'
POSTGRES_USERNAME: 'ptolemy'
POSTGRES_PASSWORD: 'ptolemy'

# auto partition the following tables by the context field specified
# NB must be a list of strings, with ':' delimit
# PARTITIONS:
#     - spanning_tree__neighbour:vlan
PARTITIONS:
    - spec: spanning_tree
      group: neighbour
      field: vlan
    - spec: caching
      group: hosts
      field:  mac_address
      modulo: 128

# internal speed up for bulk processing long messages (batches updates) for the following spec/groups
PRE_MSG_PROCESS:
    - spec: caching
      group: hosts
      fields:
        - mac_address
        - vlan
      # if False, then fail hard on pre_msg_process, True, just don't include it in search, null shoudl attempt to do something to ensure match
      fields_missing_ok: True
      # do search and cache, even if the following aren't defined (cache still strip names)
      fields_required:
        - mac_address
      # add it to teh keys if its defined, otherwise ignroe
      optional_fields:
        - ip_address

POST_MSG_PROCESS:
    - spec: caching
      group: hosts


      
# only store layer3 information for the following subnets
LAYER3_SUBNETS:
    - 134.79.0.0/16
    - 172.16.0.0/12
    - 169.254.0.0/16
    - 192.168.0.0/16
    - 10.0.0.0/8
    - 192.68.191.0/24
    - 192.88.99.0/24
    - 198.129.36.0/24
    - 198.129.37.0/24
    - 198.129.216.0/21
